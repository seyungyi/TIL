# [SQL]

## 몇가지 기본

 ### 기본키

1. 기본키(Primary Key) : 여러 키 중 가운데 가장 중요한 키. 한 테이블 내에서 중복되지 않는다.
   속성 

   - 테이블에 저장된 행을 식별할 수 있는 유일한 값이어야 함

   		- 값의 중복이 없어야 한다.
   		- NULL 값을 가질 수 없다.

2. 보조키(Alternate Key) : 대체키라고도 하며, 후보키에 속해 있는 키. 기본키로 지정되지 않은 열

3. 외래키(Foreign Key) : 특정 테이블에 포함되어 있으면서 다른 테이블의 기본키로 지정된 키

### 테이블 생성시 한글 몇글자 들어가는 문자열 타입(개수) 3byte

기존의 기본 chartSet은 UTF-16 기준이어서 '한글'문자열 길이는 length 2byte, lengthb 4byte이고,
UTF-8 기준으로는 ''한글'' 문자열 타입 개수는 length 3byte, lengthb 6byte가 출력된다. 

### select 입력시 행에대한 조건을 입력하는 위치. (행의 조건, 그룹의 조건 위치)

select [조회할 열 이름] from [조회할 테이블] where [조회할 행 조건식 or 그룹 조건]

### 컬럼값 NULL일시 어떤값으로 대신 사용하는 함수(nvl, nvl2)

NVL([NULL여부 검사 데이터 or 열], [검사 데이터가 NULL일 경우 반환할 데이터(필수)])
단, 반환할 데이터와 NULL여부 검사 데이터의 타입 형식을 주의해야한다.

NVL2([NULL여부 검사 데이터], [앞 데이터가 NULL이 아닐 경우 반환할 데이터], [NULL일 경우 반환할 데이터]);

### 연산자에서 논리연산자 and, or, 등  ||는 문자열 합침 ,등가연산자와 비등가연산자

AND : 논리연산자로서, 조건식이 여러개를 지정하게 할 수 있으며, 각 조건식이 모두 참일 경우만 결과가 정상 수행된다.
OR : 논리연산자, 여러 조건식 중 하나라도 조건을 만족한다면 결과가 정상 수행된다.
산술 연산자 : +, -, *, / 
비교 연산자 : >, >=, <, <=
등가 비교 연산자 : =(A와 B값이 같을 경우 true), !=, <>, ^=(A와 B값이 다를 경우 true)
논리 부정 연산자 : NOT
IN 연산자 : select [조회할 열 이름] from  [조회할 테이블] where 열 이름 IN (데이터);
|| 연산자 : 문자열의 조합을 위해 사용한다. (CONCAT(대상 데이터, 대상 데이터)과 같은 기능)
LIKE 연산자 : 일부 문자열이 포함된 데이터를 조회할 때 사용. LIKE '_%문자' 형식으로 사용됨.
(`-`: 어떤 값이든 상관없이 한 개의 문자 데이터를 의미, %(와일드카드) : 길이와 상관없이 모든 문자 데이터를 의미)
IS NULL : 조회하는 열의 데이터가 NULL값. 즉, 데이터의 값이 존재하지 않는다는 의미.
ALL 연산자 : 중복 제거없이 모든 결과 출력
DISTINCT : 중복되는 값을 제거하고 출력
UNION : 집합연산자(합집합). 연결된 SELECT문을 합집합으로 묶어준다. 결과값의 중복은 제거됨.
UNION ALL : UNION과 동일. 단, 중복된 결과값도 제거 없이 모두 출력
MINUS : 먼저 나온 SELECT문에서 뒤에 나온 SELECT문의 결과 값을 차집합 처리.
INTERSECT : 먼저 나온 SELECT문과 뒤에 나온 SELECT문의 결과 값이 같은 것만 출력(교집합)

### BETWEEN A AND B

일정 범위 내의 데이터를 조회할 때 주로 사용한다.
select [조회할 열] from [조회할 테이블] where 열 이름 BETWEEN 최소값 AND 최대값;

### 그룹함수는 다중행함수.  어떤 것이 있는지 파악하기.

다중행 함수(그룹 함수 or 복수행 함수) : 여러 행을 바탕으로 하나의 결과 값을 도출해내기 위해 사용하는 함수
SUM 함수 : SELECT문으로 조회된 행에 지정한 열 값을 모두 더한 값을 반환해 주는 함수
SUM(DISTINCT, ALL [중복제거 또는 모두 출력]  선택값) [합계에 사용될 데이터(필수)];
COUNT 함수 : 지정한 데이터의 개수를 반환	COUNT(함수를 사용한 데이터) OVER(분석을 위한 문법. 선택사항)
MAX 함수 : 지정한 데이터 중 최댓값 반환	MAX(데이터)
MIN 함수 : 지정한 데이터 중 최솟값 반환	MIN(데이터)
AVG 함수 : 지정한 데이터의 평균값 반환	AVG(데이터)
GROUP BY절 : 결과값을 원하는 열로 묶어 출력한다. 그룹함수를 사용시 다른 결과값을 출력할 시 반드시 사용해야한다.
SELECT [조회할 열] FROM [조회할 테이블] WHERE [조건식] GROUP BY[그룹화할 열 지정] ORDER BY[정렬하려는 열]
HAVING절 : GROUP BY절이 존재할 경우만 사용. 그룹화된 결과 값의 범위를 제한하는 데 사용
GROUP BY[그룹화 열 지정] HAVING[출력 그룹 제한하는 조건식] ORDERY BY[정렬하려는 열]

### 뭐뭐로 시작하는, 뭐뭐로 들어가는 등의 패턴비교

LIKE 연산자 : 일부 문자열이 포함된 데이터를 조회할 때 사용. LIKE '_%문자' 형식으로 사용됨.
(`-`: 어떤 값이든 상관없이 한 개의 문자 데이터를 의미, %(와일드카드) : 길이와 상관없이 모든 문자 데이터를 의미)
EX) A가 들어가는 문자열 : '%A%', 두번째가 A인 문자 : '-A%', 
IN 연산자 : select [조회할 열 이름] from  [조회할 테이블] where 열 이름 IN (데이터);

### 다중행 서브쿼리 연산자 ( all, in 등)

IN 연산자 : 메인쿼리의 데이터가 서브쿼리의 결과 중 하나라도 일치한 데이터가 있다면 TRUE
ANY, SOME : 메인쿼리의 조건식을 만족하는 서브쿼리의 결과가 하나 이상이면 TRUE
ALL : 메인쿼리의 조건식을 서브쿼리의 결과 모두가 만족하면 TRUE
EXISTS : 서브쿼리의 결과가 존재하면(즉, 행이 1개 이상일 경우) TRUE

### 날짜데이타 to_char 이용하여 원하는 형식으로 변환하는 것(년월일)

TO_CHAR([날짜 데이터], '[출력되길 원하는 문자 형태(필수)]');
'YYYY"년" MM"월" DD"일" HH24:MI:SS'  -> YYYY년 MM월 DD일 00:00:00
숫자 데이터 형식을 지정하여 출력
TO_CHAR([데이터], '999,999') AS 별칭
변환 함수

1. TO_NUMBER('[문자열 데이터(필수)]', '[인식될 숫자형태]') : 문자 데이터를 숫자 데이터로 변환
2. TO_DATE('[문자열 데이터]', '[인식될 날짜형태]')
3. CC:세기, YYYY:연(4자리), YY:연(2자리), MM:월(2자리), MON:월(월 약자), MONTH:월이름 전체, DD:일(2자리),
   DDD:1년중며칠(1~366), DY:요일(약자), DAY:요일이름전체, W:1년중 몇번째 주(1~53), D:주

날짜 함수

1. 날짜 데이터 +(-) 숫자 : 숫잠사큼 이후(이전)의 날짜. 단, 날짜 데이터끼리의 덧셈연산은 지원하지 않는다.
2. ADD_MONTHS([날짜 데이터(필수)], [더할 개월 수(필수)])
3. MONTHS_BETWEEN([날짜 데이터], [날짜 데이터]) : 날짜 간의 개월 수 차이
4. NEXT_DAY, LAST_DAY : 입력한 날짜 데이터에서 돌아오는 요일의 날짜 반환, 특정 날짜가 속한 달의 마지막 날짜
5. 날짜 데이터 포맷
   (CC:네자리 연도 끝 두자리, YYYY:해당 연월일 7월1일 기준, MONTH:각 달 16일 기준, DD:해당 일 정오기준,
   DAY:한주 시작되는 날짜 기준, HH24:해당일 시간 기준, MI:해당일 시간의 분 기준)

### DML의 종류

DML(Data Manipulation Language) : 데이터 조작 명령어.
트랜잭션 : 더이상 분할할 수 없는 최소 수행 단위. 하나의 작업 또는 밀접하게 연관된 작업 수행을 위해 한 개 이상의 데이터 조작 명령어로 이루어진다.(== SQL덩어리) 
트랜잭션 제어 사용 명령어 : TCL(Transcation Control Language), ROLLBACK:트랜잭션 취소, COMMIT:영원이 반영, LOCK:조작 중인 데이터를 다른 세션은 조작할 수 없도록 접근을 보류시키는 것
세션 : 데이터베이스 접속 시작부터 접속이 종료되기까지의 전체 기간(여러 SQL문이 하나의 작업 단위로 다뤄지는 여러 개의 트랜잭션으로 구성)

### JDBC에서 executeQuery를 반드시 사용해야하는 명령어

Statement객체를 생성하면 Statement객체의 executeQuery메소드를 호출해야 SQL문 응답을 실행시킬 수 있다.

### Statement와 PreparedStatement 종류와 정의

Statement와 PreparedStatement 모두 SQL문을 실행시켜주는 메소드다.
Statement는 DB와 연결되는 connection 객체와의 의사 소통을 위해, DB에게 명령을 내릴 때 그것을 던져주는 역할을 하는 interface로서 사용자 명령에 대응하기 위한 객체.
PreparedStatement는 statement를 상속받는 인터페이스로 SQL구문을 실행시키는 기능을 갖는 객체.
단, PreparedStatement 메소드는 동적인 작업이 많을 경우 효율적으로 PreparedStatement에 지정된 값만 변경 가능하기 때문에 준비된 Statement라고 할 수 있다.
Statement는 기본 null값으로 최초 선언하고, 필요한 데이터 컬럼열만 여러번 사용할 수 있다는 장점이 있다.

ResultSet은 실행된 결과를 받아올 수 있게 하는 메소드다.
Statement은 ResultSet의 executeUpdate("SQL문")를 통해 변화된 행의 개수를 int로 저장할 수 있고, 없다면 0리턴.
PreparedStament은 기본 setAutoCommit(true)이기에 false로 변경할 수 있고, PreparedStatement("SQL문")안에 아규먼트 조건식에 ?를 설정하여 set타입(아규먼트순서, 데이터값)으로 데이터 전달이 가능. executeQuery, executeUpdate사용

### round함수

ROUND, TRUNC([숫자], [반올림위치]) : 숫자 데이터의 반올림, 버림처리